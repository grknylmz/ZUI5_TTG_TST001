jQuery.sap.require("sap.ui.core.util.Export");































































































































































































































































jQuery.sap.require("sap.ui.core.util.ExportTypeCSV");































































































































































































































































































































































































































































































































sap.ui.controller("zui5_ttg_app001.BatchPrice", {































































































































































































































































































































































































































































































































	navBack	: function() {































































































































































































































































		sap.ui.getCore().getEventBus().publish(































































































































































































































































				"nav", 































































































































































































































































				"to", {































































































































































































































































				  viewName: "zui5_ttg_app001.Main",































































































































































































































































				  viewId: "Main"































































































































































































































































			});































































































































































































































































	},































































































































































































































































	































































































































































































































































	initialize	: function() {































































































































































































































































		this.getView().byId("batchPriceTable").removeAllItems();































































































































































































































































		this.getView().byId("btnUploadPrice").setEnabled(false);































































































































































































































































		this.getView().byId("batchPriceTemplateType").setSelectedIndex(0);































































































































































































































































		this.getView().byId("batchPriceUploader").setValue("");































































































































































































































































	},































































































































































































































































	































































































































































































































































	onChange	: function() {































































































































































































































































		var oView = sap.ui.getCore().byId("BatchPrice");































































































































































































































































		var oFileUploader = oView.byId("batchPriceUploader");































































































































































































































































		































































































































































































































































		var oModel = new sap.ui.model.odata.ODataModel("/sap/opu/odata/sap/ZGW_AKILLI_KASA_SRV_01/", false);































































































































































































































































		































































































































































































































































		oModel.refreshSecurityToken();































































































































































































































































		































































































































































































































































		var oHeaders = oModel.oHeaders;































































































































































































































































		var sToken = oHeaders['x-csrf-token'];































































































































































































































































		var oHeaderParameter = new sap.ui.unified.FileUploaderParameter({































































































































































































































































        	name: "x-csrf-token",































































































































































































































































        	value: sToken































































































































































































































































        });































































































































































































































































		































































































































































































































































		oFileUploader.removeAllHeaderParameters();































































































































































































































































		































































































































































































































































		oFileUploader.addHeaderParameter(oHeaderParameter);































































































































































































































































		































































































































































































































































		oFileUploader.insertHeaderParameter(new sap.ui.unified.FileUploaderParameter({































































































































































































































































			name: "slug",































































































































































































































































			value: unescape(encodeURIComponent(oFileUploader.getValue()))































































































































































































































































			})































































































































































































































































		);































































































































































































































































		































































































































































































































































		if (!this.oBusyDialog)































































































































































































































































			this.oBusyDialog = new sap.m.BusyDialog({ text : "Lütfen bekleyiniz" });































































































































































































































































		































































































































































































































































		this.oBusyDialog.open();































































































































































































































































		































































































































































































































































		oFileUploader.setUploadUrl("/sap/opu/odata/sap/ZGW_AKILLI_KASA_SRV_01/excelUploadSet");































































































































































































































































		oFileUploader.upload();































































































































































































































































	},































































































































































































































































	































































































































































































































































	showResults	: function() {































































































































































































































































		































































































































































































































































		var that = this;































































































































































































































































































































































































































































































































		var oResultTable = that.getView().byId("batchPriceTable");































































































































































































































































		oResultTable.removeAllItems();































































































































































































































































































































































































































































































































		if (!this.oBusyDialog)































































































































































































































































			this.oBusyDialog = new sap.m.BusyDialog({ text : "Lütfen bekleyiniz" });































































































































































































































































































































































































































































































































		this.oBusyDialog.open();































































































































































































































































































































































































































































































































		var oModel = new sap.ui.model.odata.ODataModel("/sap/opu/odata/sap/ZGW_AKILLI_KASA_SRV_01/", true);































































































































































































































































		































































































































































































































































		var oFilter = new [ sap.ui.model.Filter("Jobno", sap.ui.model.FilterOperator.EQ, sJobNo) ];































































































































































































































































		































































































































































































































































		var mParameters = {































































































































































































































































				async			: true,































































































































































































































































				filters 	  	: oFilter,































































































































































































































































				urlParameters 	: null,































































































































































































































































				success			: function(oData) {































































































































































































































































					































































































































































































































































					that.oBusyDialog.close();































































































































































































































































					































































































































































































































































					for (var i = 0; i < oData.results.length; i++) {































































































































































































































































						oResultTable.addItem(new sap.m.ColumnListItem({































































































































































































































































							cells: [































































































































































































































































						        	new sap.m.ObjectIdentifier({ text: oData.results[i].Matnr }),































































































































































































































































						        	new sap.m.Text({ text: oData.results[i].Fiyat }),































































































































































































































































						        	new sap.m.Text({ text: oData.results[i].Message })































































































































































































































































						        	]































































































































































































































































							}));































































































































































































































































						}































































































































































































































































					},































































































































































































































































				error : function() {































































































































































































































































					that.oBusyDialog.close();































































































































































































































































					var oMessageData = { TYPE:"E", MESSAGE:"Bağlantı hatası!"};































































































































































































































































					that.showMessage(oMessageData);































































































































































































































































				}































































































































































































































































			};































































































































































































































































































































































































































































































































		oModel.read("/excelResultSet", mParameters);































































































































































































































































	},































































































































































































































































	































































































































































































































































	updatePrice	: function() {































































































































































































































































		































































































































































































































































		var that = this;































































































































































































































































		































































































































































































































































		var oResultTable = that.getView().byId("batchPriceTable");































































































































































































































































		oResultTable.removeAllItems();































































































































































































































































		































































































































































































































































		if (!this.oBusyDialog)































































































































































































































































			this.oBusyDialog = new sap.m.BusyDialog({ text : "Lütfen bekleyiniz" });































































































































































































































































		































































































































































































































































		this.oBusyDialog.open();































































































































































































































































		































































































































































































































































		var oModel = new sap.ui.model.odata.ODataModel("/sap/opu/odata/sap/ZGW_AKILLI_KASA_SRV_01/", true);































































































































































































































































		































































































































































































































































		var oFilter = [































































































































































































































































		               new sap.ui.model.Filter("BayiKodu", sap.ui.model.FilterOperator.EQ, sDealerID),































































































































































































































































		   			   new sap.ui.model.Filter("Guid", sap.ui.model.FilterOperator.EQ, batchGuid)































































































































































































































































		               ];































































































































































































































































		































































































































































































































































		var mParameters = { async			: true,































































































































































































































































							filters 	  	: oFilter,































































































































































































































































							urlParameters 	: null,































































































































































































































































							success			: function(oData) {































































































































































































































































































































































































































































































































								that.oBusyDialog.close();































































































































































































































































								































































































































































































































































								if (oData.results.length == 1) {































































































































































































































































									sJobNo = oData.results[0].Jobno;































































































































































































































































									console.log(sJobNo);































































































































































































































































									var oMessageData = { TYPE: "I", MESSAGE: oData.results[0].Message };































































































































































































































































									that.showMessage(oMessageData);































































































































































































































































								}































































































































































































































































								else if (oData.results.length > 1) {								































































































































































































































































									for (var i = 0; i < oData.results.length; i++) {































































































































































































































































										oResultTable.addItem(new sap.m.ColumnListItem({































































































































































































































































											cells: [































































































































































































































































										        	new sap.m.ObjectIdentifier({ text: oData.results[i].MalzemeKodu }),































































































































































































































































										        	new sap.m.Text({ text: oData.results[i].BayiFiyati }),































































































































































































































































										        	new sap.m.Text({ text: oData.results[i].SonucText })































































































































































































































































										        	]































































































































































































































































										}));































































































































































































































































									}































































































































































































































































								}































































































































































































































































							},































































































































































































































































					  		error			: function() {































































































































































































































































								that.oBusyDialog.close();































































































































































































































































								var oMessageData = { TYPE:"E", MESSAGE:"Bağlantı hatası!" };































































































































































































































































								that.showMessage(oMessageData);































































































































































































































































							}































































































































































































































































			};































































































































































































































































































































































































































































































































		oModel.read("/fiyatUploadSet", mParameters);































































































































































































































































	},































































































































































































































































	































































































































































































































































	uploadComplete	: function(oEvent) {































































































































































































































































		































































































































































































































































		var that = this;































































































































































































































































		































































































































































































































































		var oModel = new sap.ui.model.odata.ODataModel("/sap/opu/odata/sap/ZGW_AKILLI_KASA_SRV_01/", true);































































































































































































































































		console.log(oEvent.getParameters());































































































































































































































































		var aResponse1 = oEvent.getParameters().responseRaw.split("<d:Guid>");































































































































































































































































		var aResponse2 = aResponse1[1].split("</d:Guid>");































































































































































































































































		var sGuid      = aResponse2[0];































































































































































































































































		batchGuid	   = sGuid;































































































































































































































































		































































































































































































































































		var oFilter = [































































































































































































































































		               new sap.ui.model.Filter("BayiKodu", sap.ui.model.FilterOperator.EQ, sDealerID),































































































































































































































































		   			   new sap.ui.model.Filter("Guid", sap.ui.model.FilterOperator.EQ, sGuid)































































































































































































































































		               ];































































































































































































































































		































































































































































































































































		var mParameters = { async			: true,































































































































































































































































							filters 	  	: oFilter,































































































































































































































































							urlParameters 	: null,































































































































































































































































							success			: function(oData) {































































































































































































































































								var sMessage = "";































































































































































































































































								for (var i = 0; i < oData.results.length; i++) {































































































































































































































































									sMessage += oData.results[i].SonucText + "\n";































































































































































































































































								}































































































































































































































































								































































































































































































































































								if (sMessage != "") {































































































































































































































































									var oMessageData = { TYPE: "E", MESSAGE: sMessage};































































































































































































































































									that.showMessage(oMessageData);































































































































































































































































//									priceUploadOK = false;































































































































































































































































									that.getView().byId("btnUploadPrice").setEnabled(false);































































































































































































































































									that.getView().byId("batchPriceUploader").setValue("");































































































































































































































































								}































































































































































































































































								else































































































































































































































































//									priceUploadOK = true;































































































































































































































































									that.getView().byId("btnUploadPrice").setEnabled(true);































































































































































































































































									































































































































































































































































								that.oBusyDialog.close();































































































































































































































































							},































































































































































































































































					  		error			: function() {































































































































































































































































								that.oBusyDialog.close();































































































































































































































































								var oMessageData = { TYPE:"E", MESSAGE:"Bağlantı hatası!"};































































































































































































































































								that.showMessage(oMessageData);































































































































































































































































							}































































































































































































































































			};































































































































































































































































































































































































































































































































		oModel.read("/fiyatExcelCheckSet", mParameters);































































































































































































































































	},































































































































































































































































	































































































































































































































































	onProgressUpload	: function(oEvent) {































































































































































































































































		console.log("upload progress");































































































































































































































































	},































































































































































































































































	































































































































































































































































	onTypeMissmatch	: function() {































































































































































































































































		var oMessageData = { TYPE:"E", MESSAGE:"Yalnızca xls ya da xlsx uzantılı dosya yükleyebilirsiniz!"};































































































































































































































































		this.showMessage(oMessageData);































































































































































































































































	},































































































































































































































































	































































































































































































































































	exportToExcel	: function(oEvent) {































































































































































































































































		































































































































































































































































		var oDataModel = new sap.ui.model.odata.ODataModel("/sap/opu/odata/sap/ZGW_AKILLI_KASA_SRV_01/", false);































































































































































































































































		var oView  = sap.ui.getCore().byId("BatchPrice");































































































































































































































































		var that   = oView.getController();































































































































































































































































		var isTemplate;































































































































































































































































		































































































































































































































































		var oBusyDialog = new sap.m.BusyDialog({ text : "Lütfen bekleyiniz" });































































































































































































































































		































































































































































































































































		var mParameters = { async			: true,































































































































































































































































							filters 	  	: null,































































































































































































































































							urlParameters 	: null,































































































































































































































































							success			: function(oData) {































































































































































































































































								































































































































































































































































								var j = 0;































































































































































































































































								































































































































































































































































								var file = {































































































































































































































































										  worksheets: [[]], // worksheets has one empty worksheet (array)































































































































































































































































										  creator: 'sablon', created: new Date(),































































































































































































































































										  lastModifiedBy: '', modified: new Date(),































































































































































































































































										  activeWorksheet: 0































































































































































































































































										  }, w = file.worksheets[0];































































































































































































































































								































































































































































































































































								w.name = "sheet-1";































































































































































































































































								































































































































































































































































								w.push([]);































































































































































































































































								































































































































































































































































								w[0].push("Malzeme Türü");































































































































































































































































								w[0].push("Malzeme Tanımı");































































































































































































































































								w[0].push("NMU");































































































































































































































































								w[0].push("Azami Fiyat");































































































































































































































































								w[0].push("Tavsiye Edilen Fiyat");































































































































































































































































								w[0].push("Kampanya Fiyatı");































































































































































































































































								w[0].push("Bayi Fiyatı");































































































































































































































































								































































































































































































































































								for (var i = 0; i < oData.results.length; i++) {































































































































































































































































									j = i + 1;































































































































































































































































									w.push([]);































































































































































































































































									w[j].push(oData.results[i].MalzemeTuru);































































































































































































































































									w[j].push(oData.results[i].MalzemeTanimi);































































































































































































































































									w[j].push(oData.results[i].Nmu);































































































































































































































































									w[j].push(oData.results[i].AzamiFiyat);































































































































































































































































									w[j].push(oData.results[i].TavsiyeEdilenFiyat);































































































































































































































































									w[j].push(oData.results[i].KampanyaFiyati);































































































































































































































































									w[j].push(oData.results[i].BayiFiyati);































































































































































































































































								}































































































































































































































































								































































































































































































































































//								window.location.href = xlsx(file).href();































































































































































































































































								































































































































































































































































								var excelFile = xlsx(file);































































































































































































































































								var link = document.createElement('a');































































































































































































































































								































































































































































































































































								link.href = xlsx(file).href();































































































































































































































































								if (isTemplate)































































































































































































































































									link.download = "fiyat tanımlama şablon.xlsx";































































































































































































































































								else































































































































































































































































									link.download = "fiyat tanımı yapılacak ürünler.xlsx";































































































































































































































































								































































































































































































































































								oBusyDialog.close();































































































































































































































































							    































































































































































































































































							    document.body.appendChild(link);































































































































































































































































							    































































































































































































































































							    link.click();































































































































































































































































							    































































































































































































































































							    document.body.removeChild(link);































































































































































































































































								































































































































































































































































/*								 var oModel = new sap.ui.model.json.JSONModel();































































































































































































































































								 var dataObj = {































































































































































































































































						                  "oData" : oData                                                                 































































































































































































































































						               };































































































































































































































































								 oModel.setData(dataObj);































































































































































































































































								 































































































































































































































































								 var oExport = new sap.ui.core.util.Export({































































































































































































































































										exportType	: new sap.ui.core.util.ExportType({































































































































































































































































											fileExtension	: "xls",































































































































































































































































											mimeType		: "application/vnd.ms-excel"































































































































































































































































										}),































































































































































































































































										































































































































































































































































										models		: oModel,































































































































































































































































										rows		: {































































































































































































































































											path : "/oData/results"































































































































































































































































										},































































































































































































































































										columns		: [{































































































































































































































































															name : "Malzeme Türü",































































































































































































































































															template: {































































































































































































































































																content: "{MalzemeTuru}"































































































































































































































































															}































































































































































































































































														},{































































































































































































































































															name : "Malzeme Tanımı",































































































































































































































































															template: {































































































































































































































































																content: "{MalzemeTanimi}"































































































































































































































































															 }































































































































































































































































														},{































































































































































































































































															name : "NMU",































































































































































































































































															template: {































































































































































































































































																content: "{Nmu}"































































































































































































































































															 }































































































































































































































































														},{































































































































































































































































															name : "Azami Fiyat",































































































































































































































































															template: {































































































































































































































































																content: "{AzamiFiyat}"































































































































































































































































															 }































































































































































































































































														},{































































































































































































































































															name : "Tavsiye Edilen Fiyat",































































































































































































































































															template: {































































































































































































































































																content: "{TavsiyeEdilenFiyat}"































































































































































































































































															 }































































































































































































































































														},{































































































































































































































































															name : "Kampanya Fiyatı",































































































































































































































































															template: {































































































































































































































































																content: "{KampanyaFiyati}"































































































































































































































































															 }































































































































































































































































														},{































































































































































































































































															name : "Bayi Fiyatı",































































































































































































































































															template: {































































































































































































































































																content: "{BayiFiyati}"































































































































































































































































															 }































































































































































































































































														}































































































































































































































































										       		   ]































































































































































































































































									});































































































































































































































































									































































































































































































































































									oExport.saveFile(); */































































































































































































































































							},































































































































































































































































							error			: function() {































































































































































































































































								var oMessageData = { TYPE:"E", MESSAGE:"Bağlantı Hatası!"};































































































































































































































































								that.showMessage(oMessageData);































































































































































































































































							}































































































































































































































































			};































































































































































































































































		































































































































































































































































		oView.byId("batchPriceTemplateType").getSelectedIndex() == 0 ? isTemplate = "" : isTemplate = "X";































































































































































































































































		































































































































































































































































		var sReadUrl = "fiyatSablonSet?search=DealerId=" + sDealerID + "-Istemplate=" + isTemplate;































































































































































































































































		































































































































































































































































		oBusyDialog.open();































































































































































































































































		oDataModel.read(sReadUrl, mParameters);































































































































































































































































		































































































































































































































































/*		var oView = sap.ui.getCore().byId("BatchPrice")































































































































































































































































		var bTemplate;































































































































































































































































		var isTemplate;































































































































































































































































		var sUrl;































































































































































































































































		































































































































































































































































		oView.byId("batchPriceTemplateType").getSelectedIndex() == 0 ? bTemplate = false : bTemplate = true;































































































































































































































































			































































































































































































































































//		bTemplate ?































































































































































































































































//				sUrl = "/sap/opu/odata/sap/ZGW_AKILLI_KASA_SRV_01/fiyatSablonSet?search=DealerId=" + sDealerID + "-Istemplate=X" + "&$format=xlsx" :































































































































































































































































//				sUrl = "/sap/opu/odata/sap/ZGW_AKILLI_KASA_SRV_01/fiyatSablonSet?search=DealerId=" + sDealerID + "-Istemplate= " + "&$format=xlsx";































































































































































































































































		































































































































































































































































		bTemplate ? isTemplate = "X" : isTemplate = "";































































































































































































































































				































































































































































































































































		sUrl = "/sap/opu/odata/sap/ZGW_AKILLI_KASA_SRV_01/fiyatSablonDownSet(DealerId='" +































































































































































































































































																			sDealerID +































































































































































































































































																			"',Istemplate='" +































































































































































































































































																			isTemplate + "')/$value";































































































































































































































































		































































































































































































































































		var encodeUrl = encodeURI(sUrl);































































































































































































































































		sap.m.URLHelper.redirect(encodeUrl, true); */































































































































































































































































	},































































































































































































































































































































































































































































































































/**































































































































































































































































* Called when a controller is instantiated and its View controls (if available) are already created.































































































































































































































































* Can be used to modify the View before it is displayed, to bind event handlers and do other one-time initialization.































































































































































































































































* @memberOf zui5_ttg_app001.BatchPrice































































































































































































































































*/































































































































































































































































	onInit: function() {































































































































































































































































		this.getView().addEventDelegate({































































































































































































































































			onBeforeShow : jQuery.proxy(function(evt) {































































































































































































































































				this.onBeforeShow(evt);































































































































































































































































			}, this) });































































































































































































































































	},































































































































































































































































	































































































































































































































































	onBeforeShow	: function() {































































































































































































































































		this.initialize();































































































































































































































































	},































































































































































































































































































































































































































































































































	showMessage	: function(data) {































































































































































































































































		































































































































































































































































		jQuery.sap.require("sap.m.MessageBox");































































































































































































































































		































































































































































































































































		var oIcon, sTitle;































































































































































































































































		































































































































































































































































		switch (data.TYPE) {































































































































































































































































		case "S": oIcon = sap.m.MessageBox.Icon.SUCCESS; 	 break;































































































































































































































































		case "I": oIcon = sap.m.MessageBox.Icon.INFORMATION; break;































































































































































































































































		case "E": oIcon = sap.m.MessageBox.Icon.ERROR;		 break;































































































































































































































































		case "W": oIcon = sap.m.MessageBox.Icon.WARNING;	 break;































































































































































































































































		default: break;































































































































































































































































		}































































































































































































































































		































































































































































































































































    	sap.m.MessageBox.show( data.MESSAGE, { icon		: oIcon,































































































































































































































































    										   title	: sTitle,































































































































































































































































    		          		   				   actions	: [sap.m.MessageBox.Action.OK],































































































































































































































































    		      							 });































































































































































































































































	},































































































































































































































































	































































































































































































































































/**































































































































































































































































* Similar to onAfterRendering, but this hook is invoked before the controller's View is re-rendered































































































































































































































































* (NOT before the first rendering! onInit() is used for that one!).































































































































































































































































* @memberOf zui5_ttg_app001.BatchPrice































































































































































































































































*/































































































































































































































































//	onBeforeRendering: function() {































































































































































































































































//































































































































































































































































//	},































































































































































































































































































































































































































































































































/**































































































































































































































































* Called when the View has been rendered (so its HTML is part of the document). Post-rendering manipulations of the HTML could be done here.































































































































































































































































* This hook is the same one that SAPUI5 controls get after being rendered.































































































































































































































































* @memberOf zui5_ttg_app001.BatchPrice































































































































































































































































*/































































































































































































































































//	onAfterRendering: function() {































































































































































































































































//































































































































































































































































//	},































































































































































































































































































































































































































































































































/**































































































































































































































































* Called when the Controller is destroyed. Use this one to free resources and finalize activities.































































































































































































































































* @memberOf zui5_ttg_app001.BatchPrice































































































































































































































































*/































































































































































































































































//	onExit: function() {































































































































































































































































//































































































































































































































































//	}































































































































































































































































































































































































































































































































});