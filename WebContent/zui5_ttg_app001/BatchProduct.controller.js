jQuery.sap.require("sap.ui.core.util.Export");































































































































jQuery.sap.require("sap.ui.core.util.ExportTypeCSV");































































































































































































































































sap.ui.controller("zui5_ttg_app001.BatchProduct", {































































































































































































































































	initialize: function() {































































































































		this.getView().byId("batchProductTable").removeAllItems();































































































































		this.getView().byId("batchProductUploader").setValue("");































































































































	},































































































































































































































































	navBack: function() {































































































































		sap.ui.getCore().getEventBus().publish(































































































































			"nav",































































































































			"to", {































































































































				viewName: "zui5_ttg_app001.Main",































































































































				viewId: "Main"































































































































			});































































































































	},































































































































































































































































	exportToExcel: function() {































































































































































































































































		var file = {































































































































				worksheets: [[], []], // worksheets has one empty worksheet (array)































































































































				creator: '',































































































































				created: new Date(),































































































































				lastModifiedBy: '',































































































































				modified: new Date(),































































































































				activeWorksheet: 0































































































































			},































































































































			w = file.worksheets[0],































































































































			w1 = file.worksheets[1];































































































































































































































































		w.name = "sheet-1";































































































































		w1.name = "Örnek Ürün Bilgileri";































































































































































































































































		w.push([],[]);































































































































































































































































		w[0].push("NMU");































































































































		w[0].push("NMU Tanım");































































































































		w[0].push("Ürün Hiyerarşisi");































































































































		w[0].push("Renk");































































































































		w[0].push("Serili Ürün");































































































































		w[0].push("KDV Oranı");































































































































		w[0].push("OIV Oranı");































































































































		w[0].push("TK Ruhsat Ücreti");































































































































		w[0].push("TK Kullanım Ücreti");































































































































		w[0].push("Bayi Fiyatı");































































































































































































































































		for (var i = 0; i < 10; i++) {































































































































































































































































			if (i == 5) {































































































































				w[1].push("18");































































































































			} else if (i == 6) {































































































































				w[1].push("0");































































































































			} else if (i == 7) {































































































































				w[1].push("0");































































































































			} else if (i == 8) {































































































































				w[1].push("0");































































































































			} else {































































































































				w[1].push("");































































































































			}































































































































































































































































		}































































































































































































































































		w1.push([], []);































































































































































































































































		w1[0].push("NMU");































































































































		w1[0].push("NMU Tanım");































































































































		w1[0].push("Ürün Hiyerarşisi");































































































































		w1[0].push("Renk");































































































































		w1[0].push("Serili Ürün");































































































































		w1[0].push("KDV Oranı");































































































































		w1[0].push("OIV Oranı");































































































































		w1[0].push("TK Ruhsat Ücreti");































































































































		w1[0].push("TK Kullanım Ücreti");































































































































		w1[0].push("Bayi Fiyatı");































































































































		w1[1].push("");































































































































		w1[1].push("Iphone 6S 64 GB");































































































































		w1[1].push("600050003");































































































































		w1[1].push("Beyaz");































































































































		w1[1].push("");































































































































		w1[1].push("18");































































































































		w1[1].push("0");































































































































		w1[1].push("0");































































































































		w1[1].push("0");































































































































		w1[1].push("50");































































































































































































































































		//		window.location.href = xlsx(file).href();































































































































































































































































		var excelFile = xlsx(file);































































































































		var link = document.createElement('a');































































































































































































































































		link.href = xlsx(file).href();































































































































		link.download = "ürün tanımlama şablon.xlsx";































































































































































































































































		document.body.appendChild(link);































































































































































































































































		link.click();































































































































































































































































		document.body.removeChild(link);































































































































































































































































		/*		var oModel = new sap.ui.model.json.JSONModel();































































































































		































































































































		oModel.setData({































































































































            rows : []































































































































        });































































































































		































































































































		var oExport = new sap.ui.core.util.Export({































































































































			exportType	: new sap.ui.core.util.ExportType({































































































































				fileExtension	: "xls",































































































































				mimeType		: "application/vnd.ms-excel",































































































































				charset 		: "UTF-8"































































































































			}),































































































































			































































































































			models		: oModel,































































































































			rows		: {































































































































				path : "/rows"































































































































			},































































































































			columns		: [































































































































			       		   { name : "NMU" 				 },































































































































			       		   { name : "NMU Tanım" 		 },































































































































			       		   { name : "Ürün Hiyerarşisi" 	 },































































































































			       		   { name : "Renk" 				 },































































































































			       		   { name : "Serili Ürün" 		 },































































































































			       		   { name : "KDV Oranı" 		 },































































































































			       		   { name : "OIV Oranı" 		 },































































































































			       		   { name : "TK Ruhsat Ücreti" 	 },































































































































			       		   { name : "TK Kullanım Ücreti" },































































































































			       		   { name : "Bayi Fiyatı" 		 }































































































































			       		   ]































































































































		});































































































































		































































































































		oExport.saveFile(); */































































































































	},































































































































































































































































	onChange: function() {































































































































		var oView = sap.ui.getCore().byId("BatchProduct");































































































































		var oFileUploader = oView.byId("batchProductUploader");































































































































































































































































		oView.byId("batchProductTable").removeAllItems();































































































































































































































































		var oModel = new sap.ui.model.odata.ODataModel("/sap/opu/odata/sap/ZGW_AKILLI_KASA_SRV_01/", false);































































































































































































































































		oModel.refreshSecurityToken();































































































































































































































































		var oHeaders = oModel.oHeaders;































































































































		var sToken = oHeaders['x-csrf-token'];































































































































		var oHeaderParameter = new sap.ui.unified.FileUploaderParameter({































































































































			name: "x-csrf-token",































































































































			value: sToken































































































































		});































































































































































































































































		oFileUploader.removeAllHeaderParameters();































































































































































































































































		oFileUploader.addHeaderParameter(oHeaderParameter);































































































































































































































































		oFileUploader.insertHeaderParameter(new sap.ui.unified.FileUploaderParameter({































































































































			name: "slug",































































































































			value: unescape(encodeURIComponent(oFileUploader.getValue()))































































































































		}));































































































































































































































































		if (!this.oBusyDialog)































































































































			this.oBusyDialog = new sap.m.BusyDialog({































































































































				text: "Lütfen bekleyiniz"































































































































			});































































































































































































































































		this.oBusyDialog.open();































































































































































































































































		oFileUploader.setUploadUrl("/sap/opu/odata/sap/ZGW_AKILLI_KASA_SRV_01/excelUploadSet");































































































































		oFileUploader.upload();































































































































	},































































































































	onClear: function() {































































































































		var oView = sap.ui.getCore().byId("BatchProduct");































































































































		var oFileUploader = oView.byId("batchProductUploader");































































































































		var oFileText = oFileUploader.getValue();































































































































	































































































































	if(oFileText !== ""){































































































































	    oFileUploader.setValue("");	}































































































































	































































































































	},































































































































































































































































	updateProduct: function() {































































































































































































































































		//		console.log(this.getView().byId("idHTMLFileUploader").value);































































































































































































































































		var that = this;































































































































































































































































		var oResultTable = that.getView().byId("batchProductTable");































































































































		oResultTable.removeAllItems();































































































































































































































































		if (!this.oBusyDialog)































































































































			this.oBusyDialog = new sap.m.BusyDialog({































































































































				text: "Lütfen bekleyiniz"































































































































			});































































































































































































































































		this.oBusyDialog.open();































































































































































































































































		var oModel = new sap.ui.model.odata.ODataModel("/sap/opu/odata/sap/ZGW_AKILLI_KASA_SRV_01/", true);































































































































































































































































		var oFilter = [































































































































		               new sap.ui.model.Filter("DealerId", sap.ui.model.FilterOperator.EQ, sDealerID),































































































































		   			   new sap.ui.model.Filter("Guid", sap.ui.model.FilterOperator.EQ, batchGuidP)































































































































		               ];































































































































































































































































		var mParameters = {































































































































			async: true,































































































































			filters: oFilter,































































































































			urlParameters: null,































































































































			success: function(oData) {































































































































				for (var i = 0; i < oData.results.length; i++) {































































































































					oResultTable.addItem(new sap.m.ColumnListItem({































































































































						cells: [































































































































										        new sap.m.ObjectIdentifier({































































































































								text: oData.results[i].Matnr































































































































							}),































































































































										        new sap.m.Text({































































































































								text: oData.results[i].Maktx































































































































							}),































































































































										        new sap.m.Text({































































































































								text: oData.results[i].Message































































































































							})































































































































										        ]































































































































					}));































































































































				}































































































































				that.oBusyDialog.close();































































































































			},































































































































			error: function() {































































































































				that.oBusyDialog.close();































































































































				var oMessageData = {































































































































					TYPE: "E",































































































































					MESSAGE: "Bağlantı hatası!"































































































































				};































































































































				that.showMessage(oMessageData);































































































































			}































































































































		};































































































































































































































































		oModel.read("/urunUploadSet", mParameters);































































































































	},































































































































































































































































	uploadComplete: function(oEvent) {































































































































































































































































		var that = this;































































































































































































































































		var oModel = new sap.ui.model.odata.ODataModel("/sap/opu/odata/sap/ZGW_AKILLI_KASA_SRV_01/", true);































































































































		console.log(oEvent.getParameters());































































































































		var aResponse1 = oEvent.getParameters().responseRaw.split("<d:Guid>");































































































































		var aResponse2 = aResponse1[1].split("</d:Guid>");































































































































		var sGuid = aResponse2[0];































































































































		batchGuidP = sGuid;































































































































		console.log(batchGuidP);































































































































































































































































		that.oBusyDialog.close()































































































































	},































































































































































































































































	onProgressUpload: function(oEvent) {































































































































		console.log("upload progress");































































































































	},































































































































































































































































	onTypeMissmatch: function() {































































































































		var oMessageData = {































































































































			TYPE: "E",































































































































			MESSAGE: "Yalnızca xls ya da xlsx uzantılı dosya yükleyebilirsiniz!"































































































































		};































































































































		this.showMessage(oMessageData);































































































































		this.initialize();































































































































	},































































































































































































































































	/**































































































































	 * Called when a controller is instantiated and its View controls (if available) are already created.































































































































	 * Can be used to modify the View before it is displayed, to bind event handlers and do other one-time initialization.































































































































	 * @memberOf zui5_ttg_app001.BatchProduct































































































































	 */































































































































	onInit: function() {































































































































		this.getView().addEventDelegate({































































































































			onBeforeShow: jQuery.proxy(function(evt) {































































































































				this.onBeforeShow(evt);































































































































			}, this)































































































































		});































































































































	},































































































































































































































































	onBeforeShow: function() {































































































































		this.initialize();































































































































	},































































































































































































































































	showMessage: function(data) {































































































































































































































































		jQuery.sap.require("sap.m.MessageBox");































































































































































































































































		var oIcon, sTitle;































































































































































































































































		switch (data.TYPE) {































































































































			case "S":































































































































				oIcon = sap.m.MessageBox.Icon.SUCCESS;































































































































				break;































































































































			case "I":































































































































				oIcon = sap.m.MessageBox.Icon.INFORMATION;































































































































				break;































































































































			case "E":































































































































				oIcon = sap.m.MessageBox.Icon.ERROR;































































































































				break;































































































































			case "W":































































































































				oIcon = sap.m.MessageBox.Icon.WARNING;































































































































				break;































































































































			default:































































































































				break;































































































































		}































































































































































































































































		sap.m.MessageBox.show(data.MESSAGE, {































































































































			icon: oIcon,































































































































			title: sTitle,































































































































			actions: [sap.m.MessageBox.Action.OK],































































































































		});































































































































	},































































































































































































































































	htmlUpload: function() {































































































































		console.log("uploader change invoked");































































































































	},































































































































































































































































	/**































































































































	 * Similar to onAfterRendering, but this hook is invoked before the controller's View is re-rendered































































































































	 * (NOT before the first rendering! onInit() is used for that one!).































































































































	 * @memberOf zui5_ttg_app001.BatchProduct































































































































	 */































































































































	//	onBeforeRendering: function() {































































































































	//































































































































	//	},































































































































































































































































	/**































































































































	 * Called when the View has been rendered (so its HTML is part of the document). Post-rendering manipulations of the HTML could be done here.































































































































	 * This hook is the same one that SAPUI5 controls get after being rendered.































































































































	 * @memberOf zui5_ttg_app001.BatchProduct































































































































	 */































































































































	//	onAfterRendering: function() {































































































































	//































































































































	//	},































































































































































































































































	/**































































































































	 * Called when the Controller is destroyed. Use this one to free resources and finalize activities.































































































































	 * @memberOf zui5_ttg_app001.BatchProduct































































































































	 */































































































































	//	onExit: function() {































































































































	//































































































































	//	}































































































































































































































































});