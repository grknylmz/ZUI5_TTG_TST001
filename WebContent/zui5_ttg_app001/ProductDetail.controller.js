var sBaseUrl = "";































































































































































































































































































































































































































































































































sap.ui.controller("zui5_ttg_app001.ProductDetail", {































































































































































































































































































































































































































































































































  navBack : function() {































































































































































































































































    sap.ui.getCore().getEventBus().publish("nav", "back");































































































































































































































































  },































































































































































































































































































































































































































































































































  removeFooterButtonTexts : function() {































































































































































































































































    var oFooter = this.getView().byId("prodDetailFooter");































































































































































































































































































































































































































































































































    var oContentLeft = oFooter.getContentLeft();































































































































































































































































    var oContentRight = oFooter.getContentRight();































































































































































































































































































































































































































































































































    for (var i = 0; i < oContentLeft.length; i++) {































































































































































































































































      oContentLeft[i].setText("");































































































































































































































































    }































































































































































































































































































































































































































































































































    for (var i = 0; i < oContentRight.length; i++) {































































































































































































































































      oContentRight[i].setText("");































































































































































































































































    }































































































































































































































































  },































































































































































































































































































































































































































































































































  removeTabBarFiltertexts : function() {































































































































































































































































    var oIconTabBar = this.getView().byId("prodDetailsIconTabBar");































































































































































































































































































































































































































































































































    var oIconTabBarFilter = oIconTabBar.getItems();































































































































































































































































































































































































































































































































    for (var i = 0; i < oIconTabBarFilter.length; i++) {































































































































































































































































      if (oIconTabBarFilter[i].getId().indexOf("filter") !== -1)































































































































































































































































        oIconTabBarFilter[i].setText("");































































































































































































































































    }































































































































































































































































  },































































































































































































































































































































































































































































































































/**































































































































































































































































* Called when a controller is instantiated and its View controls (if available) are already created.































































































































































































































































* Can be used to modify the View before it is displayed, to bind event handlers and do other one-time initialization.































































































































































































































































* @memberOf zui5_ttg_app001.ProductDetail































































































































































































































































*/































































































































































































































































  onInit: function() {































































































































































































































































































































































































































































































































    // register before show event































































































































































































































































    this.getView().addEventDelegate({































































































































































































































































      onBeforeShow : jQuery.proxy(function(evt) {































































































































































































































































































































































































































































































































        this.onBeforeShow(evt);































































































































































































































































































































































































































































































































        }, this) });































































































































































































































































































































































































































































































































    isProdDisplayMode = true;































































































































































































































































































































































































































































































































    var oDeviceModel = new sap.ui.model.json.JSONModel({































































































































































































































































      isTouch   : sap.ui.Device.support.touch,































































































































































































































































      isPhone   : sap.ui.Device.system.phone,































































































































































































































































      listMode  : sap.ui.Device.system.phone ? "None" : "SingleSelectMaster",































































































































































































































































      listItemType: sap.ui.Device.system.phone ? "Active" : "Inactive"































































































































































































































































    });































































































































































































































































































































































































































































































































    this.getView().setModel(oDeviceModel, "device");































































































































































































































































































































































































































































































































    var oModelComboProdType = new sap.ui.model.json.JSONModel({































































































































































































































































            data : [































































































































































































































































                    {































































































































































































































































                      "key"   : 'Z001',































































































































































































































































                      "value"   : 'NON-TTG',































































































































































































































































                  },































































































































































































































































                  {































































































































































































































































                    "key"   : 'Z002',































































































































































































































































                    "value"   : 'TTG',































































































































































































































































                  },































































































































































































































































                  {































































































































































































































































                    "key"   : 'Z003',































































































































































































































































                    "value"   : 'Hizmet',































































































































































































































































                  }































































































































































































































































                 ]































































































































































































































































      });































































































































































































































































































































































































































































































































    this.getView().byId("comboBoxProdType").setModel(oModelComboProdType);































































































































































































































































































































































































































































































































    if(sap.ui.Device.system.phone) {































































































































































































































































      this.removeFooterButtonTexts();































































































































































































































































      this.removeTabBarFiltertexts();































































































































































































































































    }































































































































































































































































    































































































































































































































































  },































































































































































































































































































































































































































































































































  handleIconTabBarSelect  : function(oData){































































































































































































































































    var that = oData.getSource().oParent.oParent.getController();































































































































































































































































































































































































































































































































    that.setFooterContent(oData.getSource().getSelectedKey());































































































































































































































































  },































































































































































































































































































































































































































































































































/**                               































































































































































































































































* Before show event































































































































































































































































* @memberOf zui5_ttg_app001.Sale































































































































































































































































*/































































































































































































































































  onBeforeShow  : function(oEvent) {































































































































































































































































    this.onBeforeRendering();































































































































































































































































  },































































































































































































































































































































































































































































































































/** 































































































































































































































































* Edit mode event































































































































































































































































* @memberOf zui5_ttg_app001.ProductMaster































































































































































































































































*/































































































































































































































































  onEdit  : function(oEvent) {































































































































































































































































































































































































































































































































    var oView = oEvent.getSource().oParent.oParent.oParent;































































































































































































































































    var oController = oView.getController();































































































































































































































































































































































































































































































































    if (!oController._editable) {































































































































































































































































      var oMessageData = { TYPE:"E", MESSAGE:"Hizmet malzemesinde değişiklik imkansız!"};































































































































































































































































      oController.showMessage(oMessageData);































































































































































































































































      return;































































































































































































































































    }































































































































































































































































    































































































































































































































































//CKAYMAZ 25.10.2016  































































































































































































































































    if (sDealerIDType == "X"){































































































































































































































































      var oMessageData = { TYPE:"E", MESSAGE:"Bu işleme yetkiniz yoktur!"};































































































































































































































































      oController.showMessage(oMessageData);































































































































































































































































      return;	































































































































































































































































    }  































































































































































































































































































































































































































































































































































































































































































































































































    oView.byId("priceBranch").setEditable(true);































































































































































































































































































































































































































































































































    oView.byId("attachmentTable").setUploadEnabled(true);































































































































































































































































    var aUploadItems = oView.byId("attachmentTable").getItems();































































































































































































































































    for (var i = 0; i < aUploadItems.length; i++) {































































































































































































































































      aUploadItems[i].setEnableDelete(true);































































































































































































































































    }































































































































































































































































































































































































































































































































    if (oView.byId("comboBoxProdType").getSelectedKey == "Z001")































































































































































































































































      oView.byId("prodDescription").setEditable(true);































































































































































































































































































































































































































































































































    oEvent.getSource().setText("İptal");































































































































































































































































    oEvent.getSource().setIcon("sap-icon://sys-cancel");































































































































































































































































    oEvent.getSource().attachPress(oController.onCancel);































































































































































































































































































































































































































































































































    if (oView.byId("prodDetailsIconTabBar").getSelectedKey() != "attachment") {































































































































































































































































      var oBarButtons = oEvent.getSource().getParent().getContentRight();































































































































































































































































      oBarButtons[oBarButtons.length - 1].setEnabled(true);































































































































































































































































    }































































































































































































































































































































































































































































































































    isProdDisplayMode = false;































































































































































































































































  },































































































































































































































































































































































































































































































































/** 































































































































































































































































* Cancel edit mode































































































































































































































































* @memberOf zui5_ttg_app001.ProductMaster































































































































































































































































*/































































































































































































































































  onCancel  : function(oEvent) {































































































































































































































































    var oView = oEvent.getSource().oParent.oParent.oParent;































































































































































































































































    var oController = oView.getController();































































































































































































































































































































































































































































































































    oView.byId("prodDescription").setEditable(false);































































































































































































































































    oView.byId("prodType").setEditable(false);































































































































































































































































    oView.byId("priceBranch").setEditable(false);































































































































































































































































    oView.byId("attachmentTable").setUploadEnabled(false);































































































































































































































































































































































































































































































































    var aUploadItems = oView.byId("attachmentTable").getItems();































































































































































































































































    for (var i = 0; i < aUploadItems.length; i++) {































































































































































































































































      aUploadItems[i].setEnableDelete(false);































































































































































































































































    }































































































































































































































































































































































































































































































































    oEvent.getSource().setText("Değiştir");































































































































































































































































    oEvent.getSource().setIcon("sap-icon://edit");































































































































































































































































    oEvent.getSource().attachPress(oController.onEdit);































































































































































































































































































































































































































































































































    if (oView.byId("prodDetailsIconTabBar").getSelectedKey() != "attachment") {































































































































































































































































      var oBarButtons = oEvent.getSource().getParent().getContentRight();































































































































































































































































      oBarButtons[oBarButtons.length - 1].setEnabled(false);































































































































































































































































    }































































































































































































































































































































































































































































































































    isProdDisplayMode = true;































































































































































































































































































































































































































































































































//    oController.onBeforeRendering();































































































































































































































































    oController.onBeforeShow();































































































































































































































































  },































































































































































































































































































































































































































































































































/** 































































































































































































































































* Icon tab bar forward navigation































































































































































































































































* @memberOf zui5_ttg_app001.ProductMaster































































































































































































































































*/































































































































































































































































  iconTabBarForward : function(oEvent) {































































































































































































































































































































































































































































































































    var that = oEvent.getSource().oParent.oParent.oParent.getController();































































































































































































































































































































































































































































































































    var oIconTabBar = that.getView().byId("prodDetailsIconTabBar");































































































































































































































































































































































































































































































































    switch (oIconTabBar.getSelectedKey()) {































































































































































































































































    case "general":































































































































































































































































      oIconTabBar.setSelectedKey("attachment");































































































































































































































































      that.setFooterContent("attachment");































































































































































































































































      break;































































































































































































































































    case "attachment":































































































































































































































































      oIconTabBar.setSelectedKey("cost");































































































































































































































































      that.setFooterContent("cost");































































































































































































































































      break;































































































































































































































































    default:































































































































































































































































      break;































































































































































































































































    }































































































































































































































































  },































































































































































































































































































































































































































































































































/** 































































































































































































































































* Icon tab bar back navigation































































































































































































































































* @memberOf zui5_ttg_app001.ProductMaster































































































































































































































































*/































































































































































































































































  iconTabBarBack  : function(oEvent) {































































































































































































































































































































































































































































































































    var oView = oEvent.getSource().oParent.oParent.oParent;































































































































































































































































































































































































































































































































    var oIconTabBar = oView.byId("prodDetailsIconTabBar");































































































































































































































































































































































































































































































































    switch (oIconTabBar.getSelectedKey()) {































































































































































































































































    case "attachment":































































































































































































































































      oIconTabBar.setSelectedKey("general");































































































































































































































































      oView.getController().setFooterContent("general");































































































































































































































































      break;































































































































































































































































    case "cost":































































































































































































































































      oIconTabBar.setSelectedKey("attachment");































































































































































































































































      oView.getController().setFooterContent("attachment");































































































































































































































































      break;































































































































































































































































    default:































































































































































































































































      break;































































































































































































































































    }































































































































































































































































  },































































































































































































































































































































































































































































































































/** 































































































































































































































































* Icon tab bar back navigation































































































































































































































































* @memberOf zui5_ttg_app001.ProductMaster































































































































































































































































*/































































































































































































































































  setFooterContent  : function(key) {































































































































































































































































































































































































































































































































    var that = this.oView.getController();































































































































































































































































































































































































































































































































    var oFooter = that.getView().byId("prodDetailFooter");































































































































































































































































































































































































































































































































    oFooter.destroyContentLeft();































































































































































































































































    oFooter.destroyContentRight();































































































































































































































































































































































































































































































































    switch (key) {































































































































































































































































    case "general":































































































































































































































































    	































































































































































































































































    	if (sDealerIDType == "X") {}































































































































































































































































    	else {































































































































































































































































        oFooter.addContentLeft(new sap.m.Button({ text  : "Yeni Ürün Ekleme",































































































































































































































































            icon  : "sap-icon://add-product",































































































































































































































































            type  : sap.m.ButtonType.Emphasized,































































































































































































































































            press : that.toNewProduct }));































































































































































































































































    	}































































































































































































































































      oFooter.addContentLeft(new sap.m.Button({ text  : "Barkod Etiketi",































































































































































































































































                            icon  : "sap-icon://bar-code",































































































































































































































































                            type  : sap.m.ButtonType.Emphasized,































































































































































































































































                            press : that.printBarcode }));































































































































































































































































                            































































































































































































































































      oFooter.addContentRight(new sap.m.Button({ text : "İleri",































































































































































































































































                             icon : "sap-icon://slim-arrow-right",































































































































































































































































                             type : sap.m.ButtonType.Emphasized,































































































































































































































































                             press: that.iconTabBarForward }));































































































































































































































































































































































































































































































































      if (isProdDisplayMode)































































































































































































































































        oFooter.addContentRight(new sap.m.Button({ text : "Değiştir",































































































































































































































































                                 icon : "sap-icon://edit",































































































































































































































































                               type : sap.m.ButtonType.Emphasized,































































































































































































































































                                 press: that.onEdit }));































































































































































































































































      else































































































































































































































































        oFooter.addContentRight(new sap.m.Button({ text : "İptal",































































































































































































































































                                   icon : "sap-icon://sys-cancel",































































































































































































































































                               type : sap.m.ButtonType.Emphasized,































































































































































































































































                                   press: that.onCancel }));































































































































































































































































































































































































































































































































      oFooter.addContentRight(new sap.m.Button({ text : "Kaydet",































































































































































































































































                             enabled: !isProdDisplayMode,































































































































































































































































                               icon : "sap-icon://save",































































































































































































































































                             type : sap.m.ButtonType.Emphasized,































































































































































































































































                             press: that.saveProduct }));































































































































































































































































      break;































































































































































































































































    case "attachment":































































































































































































































































      oFooter.addContentRight(new sap.m.Button({ text : "Geri",































































































































































































































































                               icon : "sap-icon://slim-arrow-left",































































































































































































































































                             type : sap.m.ButtonType.Emphasized,































































































































































































































































                               press: that.iconTabBarBack }));































































































































































































































































































































































































































































































































      oFooter.addContentRight(new sap.m.Button({ text : "İleri",































































































































































































































































                               icon : "sap-icon://slim-arrow-right",































































































































































































































































                             type : sap.m.ButtonType.Emphasized,































































































































































































































































                               press: that.iconTabBarForward }));































































































































































































































































































































































































































































































































      if (isProdDisplayMode)































































































































































































































































        oFooter.addContentRight(new sap.m.Button({ text : "Değiştir",































































































































































































































































                                 icon : "sap-icon://edit",































































































































































































































































                               type : sap.m.ButtonType.Emphasized,































































































































































































































































                                 press: that.onEdit }));































































































































































































































































      else































































































































































































































































        oFooter.addContentRight(new sap.m.Button({ text : "İptal",































































































































































































































































                                   icon : "sap-icon://sys-cancel",































































































































































































































































                               type : sap.m.ButtonType.Emphasized,































































































































































































































































                                   press: that.onCancel }));































































































































































































































































            































































































































































































































































/*            oFooter.addContentRight(new sap.m.Button({ text	: "Kaydet",































































































































































































































































                                   enabled: !isProdDisplayMode,































































































































































































































































                               icon : "sap-icon://save",































































































































































































































































                             type : sap.m.ButtonType.Emphasized,































































































































































































































































                             press: that.saveProduct })); */































































































































































































































































      break;































































































































































































































































    case "cost":































































































































































































































































      oFooter.addContentRight(new sap.m.Button({ text : "Geri",































































































































































































































































                               icon : "sap-icon://slim-arrow-left",































































































































































































































































                             type : sap.m.ButtonType.Emphasized,































































































































































































































































                               press: that.iconTabBarBack }));































































































































































































































































































































































































































































































































      if (isProdDisplayMode)































































































































































































































































        oFooter.addContentRight(new sap.m.Button({ text : "Değiştir",































































































































































































































































                                 icon : "sap-icon://edit",































































































































































































































































                                 type : sap.m.ButtonType.Emphasized,































































































































































































































































                                 press: that.onEdit }));































































































































































































































































      else































































































































































































































































        oFooter.addContentRight(new sap.m.Button({ text : "İptal",































































































































































































































































                                   icon : "sap-icon://sys-cancel",































































































































































































































































                               type : sap.m.ButtonType.Emphasized,































































































































































































































































                                   press: that.onCancel }));































































































































































































































































































































































































































































































































      oFooter.addContentRight(new sap.m.Button({ text : "Kaydet",































































































































































































































































                             enabled: !isProdDisplayMode,































































































































































































































































                             icon : "sap-icon://save",































































































































































































































































                             type : sap.m.ButtonType.Emphasized,































































































































































































































































                             press: that.saveProduct }));































































































































































































































































    default:































































































































































































































































      break;































































































































































































































































    }































































































































































































































































































































































































































































































































    if(sap.ui.Device.system.phone)































































































































































































































































      that.removeFooterButtonTexts();































































































































































































































































  },































































































































































































































































































































































































































































































































/**































































































































































































































































* Navigate to new product creation































































































































































































































































* @memberOf zui5_ttg_app001.ProductDetail































































































































































































































































*/































































































































































































































































  toNewProduct  : function() {































































































































































































































































	  var that = this;































































































































































































































































	  































































































































































































































































//CKAYMAZ 25.10.2016 































































































































































































































































	    if (sDealerIDType == "X"){































































































































































































































































	      var oMessageData = { TYPE:"E", MESSAGE:"Bu işleme yetkiniz yoktur!"};	            































































































































































































































































	      that.getView().getController().showMessage(oMessageData);































































































































































































































































	    }	































































































































































































































































	    































































































































































































































































	    































































































































































































































































	    else{































































































































































































































































	    	































































































































































































































































    sap.ui.getCore().getEventBus().publish(































































































































































































































































        "nav", 































































































































































































































































        "to", {































































































































































































































































         viewName: "zui5_ttg_app001.CreateNewProduct",































































































































































































































































         viewId: "CreateNewProduct"































































































































































































































































      });































































































































































































































































    































































































































































































































































  }































































































































































































































































  },































































































































































































































































































































































































































































































































/**































































































































































































































































* Similar to onAfterRendering, but this hook is invoked before the controller's View is re-rendered































































































































































































































































* (NOT before the first rendering! onInit() is used for that one!).































































































































































































































































* @memberOf zui5_ttg_app001.ProductDetail































































































































































































































































*/































































































































































































































































  onBeforeRendering: function(oEvent) {































































































































































































































































































































































































































































































































    var that = this;































































































































































































































































































































































































































































































































    var oBusyDialog = new sap.m.BusyDialog({ text : "Lütfen bekleyiniz" });































































































































































































































































































































































































































































































































    var oModel = new sap.ui.model.odata.ODataModel("/sap/opu/odata/sap/ZGW_AKILLI_KASA_SRV_01/", false);































































































































































































































































































































































































































































































































    // set detail info































































































































































































































































    var oFilter = [































































































































































































































































                   new sap.ui.model.Filter("DealerId", sap.ui.model.FilterOperator.EQ, sDealerID),































































































































































































































































                   new sap.ui.model.Filter("Matnr",    sap.ui.model.FilterOperator.EQ, sSelectedProduct)































































































































































































































































            ];































































































































































































































































































































































































































































































































    var mParameters = { async     : true,































































































































































































































































              filters       : oFilter,































































































































































































































































              urlParameters   : null,































































































































































































































































              success     : function(oData, oResponse) {































































































































































































































































































































































































































































































































                        that.setDetailData(that.getView(), oData.results[0]);































































































































































































































































































































































































































































































































                        that._editable = oData.results[0].Editable == "X" ? true : false;































































































































































































































































                          },































































































































































































































































              error     : function(error) {































































































































































































































































                        console.log(error);































































































































































































































































                        oBusyDialog.close();































































































































































































































































                        var sMessage = $(error.response.body).find('message').first().text();































































































































































































































































                        var oMessageData = { TYPE: "E", MESSAGE: sMessage };































































































































































































































































                        that.getView().getController().showMessage(oMessageData);































































































































































































































































                          }































































































































































































































































              };































































































































































































































































































































































































































































































































    oBusyDialog.open();































































































































































































































































    oModel.read("/productDetailSet?$expand=CondtnSet", mParameters); 































































































































































































































































































































































































































































































































    // get attachments































































































































































































































































    var oFilter = [































































































































































































































































                   new sap.ui.model.Filter("Matnr", sap.ui.model.FilterOperator.EQ, sSelectedProduct)































































































































































































































































            ];































































































































































































































































































































































































































































































































    var mParameters = { async     : true,































































































































































































































































              filters       : oFilter,































































































































































































































































              urlParameters   : null,































































































































































































































































              success     : function(oData, oResponse) {































































































































































































































































































































































































































































































































                        sBaseUrl = oResponse.data.__metadata.uri;































































































































































































































































































































































































































































































































                        that.setAttachmentData(that.getView(), oData);































































































































































































































































































































































































































































































































                        oBusyDialog.close();































































































































































































































































                          },































































































































































































































































              error     : function() {































































































































































































































































                        oBusyDialog.close();































































































































































































































































                        var oMessageData = { TYPE:"E", MESSAGE:"Bağlantı hatası!"};































































































































































































































































                          }































































































































































































































































              };































































































































































































































































































































































































































































































































    oModel.read("/attachmentListSet", mParameters);































































































































































































































































  },































































































































































































































































































































































































































































































































/**































































































































































































































































* Set detail info of selected product































































































































































































































































* @memberOf zui5_ttg_app001.ProductDetail































































































































































































































































*/































































































































































































































































  setDetailData : function(oView, aData) {































































































































































































































































































































































































































































































































    jQuery.sap.require("sap.ui.core.format.NumberFormat");































































































































































































































































    jQuery.sap.require("sap.ui.core.format.NumberFormat");































































































































































































































































        var oNumberFormat = sap.ui.core.format.NumberFormat.getFloatInstance({































































































































































































































































            minFractionDigits: 2,































































































































































































































































            maxFractionDigits: 2,































































































































































































































































            groupingEnabled: false,































































































































































































































































            decimalSeparator: ","































































































































































































































































          });































































































































































































































































































































































































































































































































    var taxTable   = oView.byId("taxTable");































































































































































































































































    var aCondition = [];































































































































































































































































    var sUnit;































































































































































































































































































































































































































































































































    oView.byId("comboBoxProdType").setSelectedKey(aData.Mtart);































































































































































































































































































































































































































































































































    oView.byId("stockCode").setValue(aData.Matnr);































































































































































































































































    oView.byId("prodSerialNumber").setValue(aData.Serial);































































































































































































































































    oView.byId("prodDescription").setValue(aData.Maktx);































































































































































































































































    oView.byId("prodType").setValue(aData.Wgbez);































































































































































































































































    oView.byId("prodColorCode").setValue(aData.Renkatwrt);































































































































































































































































    oView.byId("prodColor").setValue(aData.Renkatnam);































































































































































































































































































































































































































































































































    oView.byId("prodMaxPrice").setValue("");































































































































































































































































    oView.byId("prodSuggestedPrice").setValue("");































































































































































































































































    oView.byId("prodSalePrice").setValue("");































































































































































































































































    oView.byId("priceBranch").setValue("");































































































































































































































































































































































































































































































































    aData.Ifserial  == "X" ? oView.byId("isSerial").setSelected(true)  : oView.byId("isSerial").setSelected(false);































































































































































































































































    aData.Ifblocked == "X" ? oView.byId("isBlocked").setSelected(true) : oView.byId("isBlocked").setSelected(false);































































































































































































































































































































































































































































































































    aCondition = aData.CondtnSet.results;































































































































































































































































    taxTable.removeAllItems();































































































































































































































































































































































































































































































































    for (var i = 0; i < aCondition.length; i++) {































































































































































































































































      switch (aCondition[i].Kschl) {































































































































































































































































      case "ZS01":































































































































































































































































        oView.byId("prodMaxPrice").setValue(oNumberFormat.format(aCondition[i].Kwert));































































































































































































































































        break;































































































































































































































































      case "ZS02":































































































































































































































































        oView.byId("prodSuggestedPrice").setValue(oNumberFormat.format(aCondition[i].Kwert));































































































































































































































































        break;































































































































































































































































      case "VKA0":































































































































































































































































        oView.byId("prodSalePrice").setValue(oNumberFormat.format(aCondition[i].Kwert));































































































































































































































































        break;































































































































































































































































      case "ZS03":































































































































































































































































        oView.byId("priceBranch").setValue(oNumberFormat.format(aCondition[i].Kwert));































































































































































































































































        break;































































































































































































































































      default:































































































































































































































































        (aCondition[i].Kschl == "MWSI" || aCondition[i].Kschl == "ZV01") ? sUnit = "%" : sUnit = "TL";































































































































































































































































































































































































































































































































        taxTable.addItem(new sap.m.ColumnListItem({































































































































































































































































          cells: [































































































































































































































































                  new sap.m.ObjectIdentifier({text: aCondition[i].Kschl}),































































































































































































































































                  new sap.m.Text({text: aCondition[i].Vtext}),































































































































































































































































                  new sap.m.ObjectNumber({number: oNumberFormat.format(aCondition[i].Kwert), unit: sUnit}),































































































































































































































































                  new sap.m.Text({text: aCondition[i].Taxkm})































































































































































































































































                  ]































































































































































































































































        }));































































































































































































































































        break;































































































































































































































































      }































































































































































































































































    }































































































































































































































































  },































































































































































































































































































































































































































































































































  setAttachmentData : function(oView, oData) {































































































































































































































































































































































































































































































































    var oDataCopy = oData;































































































































































































































































































































































































































































































































    var oModel = new sap.ui.model.odata.ODataModel("/sap/opu/odata/sap/ZGW_AKILLI_KASA_SRV_01/", false);































































































































































































































































































































































































































































































































    var oAttachmentTable = oView.byId("attachmentTable");































































































































































































































































































































































































































































































































    oAttachmentTable.destroyItems();































































































































































































































































































































































































































































































































    var oModelAttc = new sap.ui.model.json.JSONModel();































































































































































































































































    var oDataAttc  = {};































































































































































































































































    var aItems     = [];































































































































































































































































































































































































































































































































    for (var i = 0; i < oDataCopy.results.length; i++) {































































































































































































































































































































































































































































































































      var sRead = "/attachmentSet(Matnr='" + sSelectedProduct + "',ObjkeyB='" + oDataCopy.results[i].ObjkeyB + "')" + "/$value";































































































































































































































































//      var sUrl = "http://10.4.205.30:8000/sap/opu/odata/sap/ZGW_AKILLI_KASA_SRV_01/attachmentSet(Matnr='" + sSelectedProduct + "',ObjkeyB='" + oDataCopy.results[i].ObjkeyB + "',Name='" + oDataCopy.results[i].Name + "')/$value";































































































































































































































































      var sUrl = sBaseUrl.split("ZGW_AKILLI_KASA_SRV_01/")[0] +































































































































































































































































             "ZGW_AKILLI_KASA_SRV_01/attachmentSet(Matnr='" + sSelectedProduct +































































































































































































































































             "',ObjkeyB='" + oDataCopy.results[i].ObjkeyB +































































































































































































































































             "',Name='" + oDataCopy.results[i].Name + "')/$value";































































































































































































































































































































































































































































































































      var oItem = {































































































































































































































































              "documentId"  : oDataCopy.results[i].ObjkeyB,































































































































































































































































              "fileName"    : oDataCopy.results[i].Name,































































































































































































































































              "mimeType"    : oDataCopy.results[i].Mimetype,































































































































































































































































              "url"     : sUrl,































































































































































































































































              "enableEdit"  : false,































































































































































































































































              "enableDelete"  : !isProdDisplayMode,































































































































































































































































              "visibleEdit" : false































































































































































































































































            }































































































































































































































































































































































































































































































































      aItems.unshift(oItem);































































































































































































































































    }































































































































































































































































































































































































































































































































    oDataAttc = { "items" : aItems };































































































































































































































































































































































































































































































































    oModelAttc.setData(oDataAttc);































































































































































































































































    oAttachmentTable.setModel(oModelAttc);































































































































































































































































  },































































































































































































































































































































































































































































































































/**































































































































































































































































* Display attachment preview































































































































































































































































* @memberOf zui5_ttg_app001.ProductDetail































































































































































































































































*/































































































































































































































































  attachmentPreview : function(oEvent) {































































































































































































































































































































































































































































































































  },































































































































































































































































































































































































































































































































/**































































































































































































































































* Display attachment































































































































































































































































* @memberOf zui5_ttg_app001.ProductDetail































































































































































































































































*/































































































































































































































































  displayAttachment : function(oEvent) {































































































































































































































































































































































































































































































































  },































































































































































































































































































































































































































































































































/**































































































































































































































































* Event handler for uploader change































































































































































































































































* @memberOf zui5_ttg_app001.ProductDetail































































































































































































































































*/































































































































































































































































  uploadAttachment  : function(oEvent) {































































































































































































































































































































































































































































































































  },































































































































































































































































































































































































































































































































  onBeforeUploadStarts  : function(oEvent) {































































































































































































































































    console.log("onBeforeUploadStarts");































































































































































































































































































































































































































































































































    var oUploadCollection = oEvent.getSource();































































































































































































































































        































































































































































































































































        oUploadCollection.insertHeaderParameter(new sap.m.UploadCollectionParameter({































































































































































































































































      name: "slug",































































































































































































































































      value: unescape(encodeURIComponent(oEvent.getParameter("fileName")))































































































































































































































































    }));































































































































































































































































  },































































































































































































































































































































































































































































































































  onChange  : function(oEvent) {































































































































































































































































































































































































































































































































    var oModel = new sap.ui.model.odata.ODataModel("/sap/opu/odata/sap/ZGW_AKILLI_KASA_SRV_01/", false);































































































































































































































































    var oUploadCollection = oEvent.getSource();































































































































































































































































































































































































































































































































    oModel.refreshSecurityToken();































































































































































































































































































































































































































































































































    var oHeaders = oModel.oHeaders;































































































































































































































































        var sToken = oHeaders['x-csrf-token'];































































































































































































































































        var oHeaderParameter = new sap.m.UploadCollectionParameter({































































































































































































































































          name: "x-csrf-token",































































































































































































































































          value: sToken































































































































































































































































        });































































































































































































































































































































































































































































































































        oUploadCollection.addHeaderParameter(oHeaderParameter);































































































































































































































































        































































































































































































































































        oUploadCollection.insertHeaderParameter(new sap.m.UploadCollectionParameter({































































































































































































































































      name: "slug",































































































































































































































































      value: unescape(encodeURIComponent(oEvent.getParameters().mParameters.newValue))































































































































































































































































    }));































































































































































































































































































































































































































































































































    var sUploadURL = "/sap/opu/odata/sap/ZGW_AKILLI_KASA_SRV_01/attachmentListSet('" + sSelectedProduct + "')/attachmentSet";































































































































































































































































































































































































































































































































    oUploadCollection.setUploadUrl(sUploadURL);































































































































































































































































  },































































































































































































































































































































































































































































































































  onUploadComplete  : function(oEvent) {































































































































































































































































































































































































































































































































    console.log(oEvent);































































































































































































































































    console.log(oEvent.getParameters());































































































































































































































































































































































































































































































































    var that = this;































































































































































































































































































































































































































































































































    var oModel = new sap.ui.model.odata.ODataModel("/sap/opu/odata/sap/ZGW_AKILLI_KASA_SRV_01/", false);































































































































































































































































































































































































































































































































    var oFilter = [































































































































































































































































                   new sap.ui.model.Filter("Matnr", sap.ui.model.FilterOperator.EQ, sSelectedProduct)































































































































































































































































            ];































































































































































































































































































































































































































































































































    var mParameters = {































































































































































































































































    		async     		: true,































































































































































































































































            filters       	: oFilter,































































































































































































































































            urlParameters   : null,































































































































































































































































            success     	: function(oData, oResponse) {































































































































































































































































            	































































































































































































































































            	sBaseUrl = oResponse.data.__metadata.uri;































































































































































































































































































































































































































































































































                that.setAttachmentData(that.getView(), oData);































































































































































































































































                          },































































































































































































































































            error     		: function() {































































































































































































































































            	var oMessageData = { TYPE:"E", MESSAGE:"Bağlantı hatası!" };































































































































































































































































            }































































































































































































































































        };































































































































































































































































































































































































































































































































    oModel.read("/attachmentListSet", mParameters); 































































































































































































































































  },































































































































































































































































































































































































































































































































  onFileDeleted : function(oEvent) {































































































































































































































































































































































































































































































































    var that = this;































































































































































































































































































































































































































































































































    var sDocumentId = oEvent.getParameter("documentId");































































































































































































































































    var sName   = oEvent.getParameter("item").mProperties.fileName;































































































































































































































































































































































































































































































































    var oModel = new sap.ui.model.odata.ODataModel("/sap/opu/odata/sap/ZGW_AKILLI_KASA_SRV_01/", false);































































































































































































































































































































































































































































































































    var sReadURL = "/attachmentSet(Matnr='" + sSelectedProduct + "',ObjkeyB='" + sDocumentId + "',Name='" + sName + "')";































































































































































































































































































































































































































































































































    var mParameters = { async     : true,































































































































































































































































              filters       : null,































































































































































































































































              urlParameters   : null,































































































































































































































































              success     : function(oData, oResponse) {































































































































































































































































                        var oAttachmentTable = that.getView().byId("attachmentTable");































































































































































































































































                        var oData = oAttachmentTable.getModel().getData();































































































































































































































































                        var aItems = jQuery.extend(true, {}, oData).items;































































































































































































































































































































































































































































































































                        jQuery.each(aItems, function(index){































































































































































































































































                          if (aItems[index] && aItems[index].documentId === sDocumentId)































































































































































































































































                            aItems.splice(index, 1);































































































































































































































































                        });































































































































































































































































































































































































































































































































                        oAttachmentTable.getModel().setData({































































































































































































































































                          "items" : aItems































































































































































































































































                        }); 































































































































































































































































                          },































































































































































































































































              error     : function(oData, oResponse) {































































































































































































































































                        console.log(oData);































































































































































































































































                        console.log(oResponse);































































































































































































































































                          }































































































































































































































































              };































































































































































































































































































































































































































































































































    oModel.remove(sReadURL, mParameters);































































































































































































































































  },































































































































































































































































































































































































































































































































  printBarcode  : function(oEvent) {































































































































































































































































































































































































































































































































    var oModel = new sap.ui.model.odata.ODataModel("/sap/opu/odata/sap/ZGW_AKILLI_KASA_SRV_01/", false);































































































































































































































































    var oView = oEvent.getSource().oParent.oParent.oParent;































































































































































































































































    var oSerialEntry = new sap.m.Input({ value: oView.byId("prodSerialNumber").getValue(), maxLength: 40, editable: true });































































































































































































































































    var displayDialog;































































































































































































































































































































































































































































































































    var oPrinterType = new sap.m.RadioButtonGroup({































































































































































































































































           columns: 4,































































































































































































































































             buttons: [































































































































































































































































                       new sap.m.RadioButton({ text: "46x21" }),































































































































































































































































                       new sap.m.RadioButton({ text: "52.5x33" }),































































































































































































































































                       new sap.m.RadioButton({ text: "Rulo" })































































































































































































































































                       ]































































































































































































































































       	   });































































































































































































































































































































































































































































































































    var oBarcodeForm = new sap.ui.layout.form.SimpleForm({































































































































































































































































      content : [































































































































































































































































                 new sap.m.Label({ text: "Stok Kodu (NMU)" }),































































































































































































































































                 new sap.m.Input({ value: oView.byId("stockCode").getValue(), editable: false }),































































































































































































































































                 new sap.m.Label({ text: "Seri No" }),































































































































































































































































                 oSerialEntry,































































































































































































































































                 new sap.m.Label({ text: "Ürün Tanımı" }),































































































































































































































































                 new sap.m.Input({ value: oView.byId("prodDescription").getValue(), editable: false }),































































































































































































































































                 new sap.m.Label({ text: "Yazıcı" }),































































































































































































































































                 oPrinterType,































































































































































































































































                 ]































































































































































































































































    });































































































































































































































































































































































































































































































































    if (!this.oDialog) {































































































































































































































































      this.oDialog = new sap.m.Dialog({































































































































































































































































        title   : "Etiket Bilgileri",































































































































































































































































        rightButton : new sap.m.Button({































































































































































































































































          text  : "İptal",































































































































































































































































          type  : sap.m.ButtonType.Emphasized,































































































































































































































































          icon  : "sap-icon://decline",































































































































































































































































          press : function(){ this.oParent.close(); }































































































































































































































































        }),































































































































































































































































        leftButton: new sap.m.Button({































































































































































































































































          text  : "Etiketi yazdır",































































































































































































































































          type  : sap.m.ButtonType.Emphasized,































































































































































































































































          icon  : "sap-icon://bar-code",































































































































































































































































          press : function(){































































































































































































































































































































































































































































































































            var sType;































































































































































































































































































































































































































































































































            oPrinterType.getSelectedIndex() == 0 ? sType = "1" : sType = "2";































































































































































































































































































































































































































































































































            var sReadString = "/printBarcodeSet(Matnr='" +































































































































































































































































                      oView.byId("stockCode").getValue() +































































































































































































































































                      "',Serino='" + oSerialEntry.getValue() +































































































































































































































































                      "',Type='" + sType +































































































































































































































































                      "')/$value";































































































































































































































































































































































































































































































































            var mParameters = { async     : true,































































































































































































































































                      filters       : null,































































































































































































































































                      urlParameters   : null,































































































































































































































































                      success     : function(oData, oResponse) {































































































































































































































































































































































































































































































































                          var pdfURL = oResponse.requestUri;































































































































































































































































































































































































































































































































                          var encodeUrl = encodeURI(pdfURL);































































































































































































































































                          sap.m.URLHelper.redirect(encodeUrl, true);































































































































































































































































                          },































































































































































































































































                  error     : function() {































































































































































































































































                          oBusyDialog.close();































































































































































































































































                          var oMessageData = { TYPE:"E", MESSAGE:"Bağlantı hatası!"};































































































































































































































































                          oView.getController().showMessage(oMessageData);































































































































































































































































                        }































































































































































































































































                };































































































































































































































































































































































































































































































































            oModel.read(sReadString, mParameters); 































































































































































































































































          }































































































































































































































































        }),































































































































































































































































        content: [ oBarcodeForm ]































































































































































































































































        });































































































































































































































































    }































































































































































































































































































































































































































































































































    this.oDialog.open();































































































































































































































































  },































































































































































































































































































































































































































































































































/**































































































































































































































































* Display message































































































































































































































































* @memberOf zui5_ttg_app001.ProductDetail































































































































































































































































*/































































































































































































































































  saveProduct : function(oEvent) {































































































































































































































































































































































































































































































































    jQuery.sap.require("sap.ui.core.format.NumberFormat");































































































































































































































































    jQuery.sap.require("sap.ui.core.format.NumberFormat");































































































































































































































































        var oNumberFormat = sap.ui.core.format.NumberFormat.getFloatInstance({































































































































































































































































            minFractionDigits: 2,































































































































































































































































            maxFractionDigits: 2,































































































































































































































































            groupingEnabled: false,































































































































































































































































            decimalSeparator: ","































































































































































































































































          });































































































































































































































































































































































































































































































































    var oModel    = new sap.ui.model.odata.ODataModel("/sap/opu/odata/sap/ZGW_AKILLI_KASA_SRV_01/", true);































































































































































































































































    var oBusyDialog = new sap.m.BusyDialog({ text : "Lütfen bekleyiniz" });































































































































































































































































    var oView     = oEvent.getSource().oParent.oParent.oParent;































































































































































































































































    var oController = oView.getController();































































































































































































































































































































































































































































































































    if (!oController._editable) {































































































































































































































































      var oMessageData = { TYPE:"E", MESSAGE:"Hizmet malzemesinde değişiklik imkansız!"};































































































































































































































































      oController.showMessage(oMessageData);































































































































































































































































      return;































































































































































































































































    }































































































































































































































































































































































































































































































































    // check branch price































































































































































































































































//    if (parseFloat(oView.byId("priceBranch").getValue()) > 99999.99) {































































































































































































































































    if (oNumberFormat.parse(oView.byId("priceBranch").getValue()) > 99999.99) {































































































































































































































































      var oMessageData = { TYPE: "E", MESSAGE: "Bayi fiyatı en fazla 5 basamaklı olabilir!" };































































































































































































































































      oView.getController().showMessage(oMessageData);































































































































































































































































      return;































































































































































































































































    }































































































































































































































































































































































































































































































































    oBusyDialog.open();































































































































































































































































































































































































































































































































    var aTaxes = oView.byId("taxTable").getItems();































































































































































































































































    var fKdv    = "";































































































































































































































































    var fOiv    = "";































































































































































































































































    var fRuhsat   = "";































































































































































































































































    var fKullanim = "";































































































































































































































































    var sIsSerial;































































































































































































































































































































































































































































































































    oView.byId("isSerial").getSelected() ? sIsSerial = "X" : sIsSerial = "";































































































































































































































































































































































































































































































































    for (var i = 0; i < aTaxes.length; i++) {































































































































































































































































      switch (aTaxes[i].getCells()[0].getText()) {































































































































































































































































      case "MWSI":































































































































































































































































        fKdv = aTaxes[i].getCells()[3].getText();































































































































































































































































        break;































































































































































































































































      case "ZV01":































































































































































































































































        fOiv = aTaxes[i].getCells()[3].getText();































































































































































































































































        break;































































































































































































































































      case "ZV04":































































































































































































































































        fKullanim = aTaxes[i].getCells()[3].getText();































































































































































































































































        break;































































































































































































































































      case "ZV05":































































































































































































































































        fRuhsat = aTaxes[i].getCells()[3].getText();































































































































































































































































        break;































































































































































































































































      default:































































































































































































































































        break;































































































































































































































































      }































































































































































































































































    }































































































































































































































































































































































































































































































































    var requestProdHeader = {};































































































































































































































































































































































































































































































































    requestProdHeader.Matnr     = oView.byId("stockCode").getValue();































































































































































































































































    requestProdHeader.Maktx     = oView.byId("prodDescription").getValue();































































































































































































































































    requestProdHeader.Renk      = oView.byId("prodColorCode").getValue();































































































































































































































































    requestProdHeader.Matkl     = "";































































































































































































































































    requestProdHeader.DealerId    = sDealerID;































































































































































































































































    requestProdHeader.BayiFiyat   = oNumberFormat.parse(oView.byId("priceBranch").getValue()).toString();































































































































































































































































    requestProdHeader.Seriu     = sIsSerial;































































































































































































































































    requestProdHeader.KdvOrani    = fKdv;































































































































































































































































    requestProdHeader.OivOrani    = fOiv;































































































































































































































































    requestProdHeader.RuhsatUcret = fRuhsat;































































































































































































































































    requestProdHeader.KullanimUcret = fKullanim;































































































































































































































































    requestProdHeader.Ztext     = "";































































































































































































































































    requestProdHeader.Message   = "";































































































































































































































































































































































































































































































































    oModel.setHeaders({































































































































































































































































        "Access-Control-Allow-Origin" : "*",  































































































































































































































































        "Content-Type": "application/x-www-form-urlencoded",  































































































































































































































































        "X-CSRF-Token":"Fetch"































































































































































































































































       });  































































































































































































































































































































































































































































































































    var token;































































































































































































































































































































































































































































































































    oModel.read('/changeCreateMatSet',   































































































































































































































































          null,   































































































































































































































































          null,   































































































































































































































































          false,   































































































































































































































































          function(oData, oResponse) {  































































































































































































































































            token = oResponse.headers['x-csrf-token'];  































































































































































































































































          },  































































































































































































































































          function() {  































































































































































































































































            alert("Error on read process");  































































































































































































































































          }  































































































































































































































































        );































































































































































































































































































































































































































































































































   oModel.setHeaders({  































































































































































































































































              "X-Requested-With": "XMLHttpRequest",































































































































































































































































              "Content-Type": "application/json",































































































































































































































































              "DataServiceVersion": "2.0",































































































































































































































































              "Accept": "application/atom+xml,application/atomsvc+xml,application/xml",































































































































































































































































              "X-CSRF-Token": token































































































































































































































































              });































































































































































































































































   































































































































































































































































   console.log(requestProdHeader);































































































































































































































































   































































































































































































































































   oModel.create('/changeCreateMatSet',   































































































































































































































































          requestProdHeader,   































































































































































































































































            null,   































































































































































































































































            function(oData, oResponse) {































































































































































































































































            console.log(oData);































































































































































































































































              oBusyDialog.close();































































































































































































































































































































































































































































































































              var aButtons = oView.byId("prodDetailFooter").getContentRight();































































































































































































































































              for (var i = 0; i < aButtons.length; i++) {































































































































































































































































              switch (aButtons[i].getText()) {































































































































































































































































              case "İptal":































































































































































































































































                aButtons[i].setText("Değiştir");































































































































































































































































                aButtons[i].setIcon("sap-icon://edit");































































































































































































































































                aButtons[i].attachPress(oView.getController().onEdit);































































































































































































































































                break;































































































































































































































































              case "Kaydet":































































































































































































































































                aButtons[i].setEnabled(false);































































































































































































































































              default:































































































































































































































































                break;































































































































































































































































              }































































































































































































































































            }































































































































































































































































































































































































































































































































              oView.byId("prodDescription").setEditable(false);































































































































































































































































              oView.byId("prodType").setEditable(false);































































































































































































































































              oView.byId("priceBranch").setEditable(false);































































































































































































































































































































































































































































































































              isProdDisplayMode = true;































































































































































































































































































































































































































































































































              var oMessageData = { TYPE:"I", MESSAGE:oData.Message };































































































































































































































































            oView.getController().showMessage(oMessageData); 































































































































































































































































            },  































































































































































































































































            function() {   































































































































































































































































              oBusyDialog.close();































































































































































































































































              var oMessageData = { TYPE:"E", MESSAGE:"Değişiklikler kaydedilemedi!"};































































































































































































































































            oView.getController().showMessage(oMessageData); 































































































































































































































































            }); 































































































































































































































































   































































































































































































































































   oView.getController().onBeforeShow();































































































































































































































































  },































































































































































































































































































































































































































































































































  onTypeMissmatch : function() {































































































































































































































































    var oMessageData = { TYPE:"E", MESSAGE:"Seçtiğiniz dosya tipi desteklenmiyor!"};































































































































































































































































    this.showMessage(oMessageData);































































































































































































































































  },































































































































































































































































































































































































































































































































  onUploadTerminated  : function() {































































































































































































































































    console.log("upload terminated");































































































































































































































































  },































































































































































































































































































































































































































































































































/**































































































































































































































































* Display message































































































































































































































































* @memberOf zui5_ttg_app001.ProductDetail































































































































































































































































*/































































































































































































































































    showMessage : function(data) {































































































































































































































































































































































































































































































































      jQuery.sap.require("sap.m.MessageBox");































































































































































































































































































































































































































































































































      var oIcon, sTitle;































































































































































































































































































































































































































































































































      switch (data.TYPE) {































































































































































































































































      case "S": oIcon = sap.m.MessageBox.Icon.SUCCESS;   break;































































































































































































































































      case "I": oIcon = sap.m.MessageBox.Icon.INFORMATION; break;































































































































































































































































      case "E": oIcon = sap.m.MessageBox.Icon.ERROR;     break;































































































































































































































































      case "W": oIcon = sap.m.MessageBox.Icon.WARNING;   break;































































































































































































































































      default: break;































































































































































































































































      }































































































































































































































































































































































































































































































































        sap.m.MessageBox.show( data.MESSAGE, { icon   : oIcon,































































































































































































































































                             title  : sTitle,































































































































































































































































                                     actions  : [sap.m.MessageBox.Action.OK],































































































































































































































































                               });































































































































































































































































    },































































































































































































































































































































































































































































































































    priceBranchChange : function() {































































































































































































































































      var that = this;































































































































































































































































































































































































































































































































      var sPrice = this.getView().byId("priceBranch").getValue();































































































































































































































































































































































































































































































































      if (sPrice.indexOf(".") != -1) {































































































































































































































































        var oMessageData = { TYPE:"E", MESSAGE:"Küsürat için nokta yerine virgül kullanınız!"};































































































































































































































































        that.showMessage(oMessageData);































































































































































































































































































































































































































































































































        sPrice = sPrice.slice(0,-1);































































































































































































































































        that.getView().byId("priceBranch").setValue(sPrice);































































































































































































































































      }































































































































































































































































    },































































































































































































































































































































































































































































































































/**































































































































































































































































* Called when the View has been rendered (so its HTML is part of the document). Post-rendering manipulations of the HTML could be done here.































































































































































































































































* This hook is the same one that SAPUI5 controls get after being rendered.































































































































































































































































* @memberOf zui5_ttg_app001.ProductDetail































































































































































































































































*/































































































































































































































































//  onAfterRendering: function() {































































































































































































































































//































































































































































































































































//  },































































































































































































































































































































































































































































































































/**































































































































































































































































* Called when the Controller is destroyed. Use this one to free resources and finalize activities.































































































































































































































































* @memberOf zui5_ttg_app001.ProductDetail































































































































































































































































*/































































































































































































































































//  onExit: function() {































































































































































































































































//































































































































































































































































//  }































































































































































































































































































































































































































































































































});